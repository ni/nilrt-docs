
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>NI Linux Real-Time and opkg-keyrings: Upgrading keyrings &#8212; nilrt-docs 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css?v=5283bb3d" />
    
    <script src="../_static/documentation_options.js?v=a681ed88"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NI Linux Real-Time and Docker" href="../docker/docker.html" />
    <link rel="prev" title="NI Linux Real-Time and opkg: Distributing DKMS-based Kernel Modules" href="../opkg/dkms_opkg.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../docker/docker.html" title="NI Linux Real-Time and Docker"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../opkg/dkms_opkg.html" title="NI Linux Real-Time and opkg: Distributing DKMS-based Kernel Modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">nilrt-docs 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NI Linux Real-Time and <cite>opkg-keyrings</cite>: Upgrading keyrings</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="ni-linux-real-time-and-opkg-keyrings-upgrading-keyrings">
<h1>NI Linux Real-Time and <cite>opkg-keyrings</cite>: Upgrading keyrings<a class="headerlink" href="#ni-linux-real-time-and-opkg-keyrings-upgrading-keyrings" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id3">Introduction</a></p></li>
<li><p><a class="reference internal" href="#how-to-upgrade-the-keyring-via-the-command-line-max-or-systemlink" id="id4">How to upgrade the keyring via the command line, MAX, or SystemLink</a></p>
<ul>
<li><p><a class="reference internal" href="#command-line" id="id5">Command Line</a></p></li>
<li><p><a class="reference internal" href="#max" id="id6">MAX</a></p></li>
<li><p><a class="reference internal" href="#systemlink" id="id7">SystemLink</a></p></li>
<li><p><a class="reference internal" href="#purpose-of-the-opkg-keyrings-package" id="id8">Purpose of the <cite>opkg-keyrings</cite> package</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#opkg-signing" id="id9">Opkg Signing</a></p></li>
<li><p><a class="reference internal" href="#how-keys-are-added-to-the-opkg-keyrings" id="id10">How keys are added to the <cite>opkg-keyrings</cite></a></p></li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Introduction</a><a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The <cite>opkg-keyrings</cite> package is a critical component in systems using opkg for
package management. It contains a collection of public signing keys used to
verify the authenticity and integrity of the package feeds.</p>
<p>The <cite>opkg-keyrings</cite> package is updated periodically to add new keys or remove
expired keys. It is important to keep the keyrings up-to-date to ensure that
packages can be verified and installed correctly.</p>
<p>This document provides instructions on how to upgrade the <cite>opkg-keyrings</cite>
package on NI Linux Real-Time systems.</p>
</section>
<section id="how-to-upgrade-the-keyring-via-the-command-line-max-or-systemlink">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">How to upgrade the keyring via the command line, MAX, or SystemLink</a><a class="headerlink" href="#how-to-upgrade-the-keyring-via-the-command-line-max-or-systemlink" title="Link to this heading">¶</a></h2>
<section id="command-line">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Command Line</a><a class="headerlink" href="#command-line" title="Link to this heading">¶</a></h3>
<p>Note: The following instructions only work when the target has the base system image installed and is booted
into runmode, and is connected to the internet.</p>
<p>Connect to the RT target via SSH and run the following command (or directly use the terminal on the target):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>opkg<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>opkg<span class="w"> </span>upgrade<span class="w"> </span><span class="sb">`</span>opkg-keyrings<span class="sb">`</span>
</pre></div>
</div>
</section>
<section id="max">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">MAX</a><a class="headerlink" href="#max" title="Link to this heading">¶</a></h3>
<p>Note: The following instructions only work when the target has the base system image installed and is booted
into runmode, and is connected to the internet.</p>
<section id="adding-the-rt-target-to-max">
<h4>Adding the RT target to MAX<a class="headerlink" href="#adding-the-rt-target-to-max" title="Link to this heading">¶</a></h4>
<p>Right-click on “Remote Systems” and then “Create New …”.
Select “Remote Device (not on the local subnet)”. Enter the target’s
host name or IP address, and proceed to “Finish”.</p>
</section>
<section id="upgrading-the-opkg-keyrings-package">
<h4>Upgrading the <cite>opkg-keyrings</cite> package<a class="headerlink" href="#upgrading-the-opkg-keyrings-package" title="Link to this heading">¶</a></h4>
<p>Expand the target and click on the option to “Add/Remove software” on the
target. On the Upgrade tab, there should be an option to upgrade
<cite>opkg-keyrings</cite>. Upgrading this package should get the
new signing keys installed to the target and added to the keyring.</p>
</section>
</section>
<section id="systemlink">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">SystemLink</a><a class="headerlink" href="#systemlink" title="Link to this heading">¶</a></h3>
<section id="adding-the-rt-target-to-systemlink">
<h4>Adding the RT target to SystemLink<a class="headerlink" href="#adding-the-rt-target-to-systemlink" title="Link to this heading">¶</a></h4>
<p>Note: The following instructions assume that a SystemLink server is already set up.</p>
<p>Once the RT target has been added to MAX, it can be added to a SystemLink server by
scrolling down to the “SystemLink” section on the required target, and entering the
SystemLink server’s IP address or hostname.</p>
<p>Launch and log in to the SystemLink web application. Click Systems
and then click Pending systems. Select the desired target to connect.</p>
</section>
<section id="id1">
<h4>Upgrading the <cite>opkg-keyrings</cite> package<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<p>This requires creating a State in SystemLink and applying it to the target.</p>
<p>Create a State by navigating to States under System Management. Click on Create State.
Under the Editor tab of the newly created State, add the following and save:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">install_updates</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cmd.run</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;opkg</span><span class="nv"> </span><span class="s">update</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">opkg</span><span class="nv"> </span><span class="s">upgrade</span><span class="nv"> </span><span class="s">`opkg-keyrings`&#39;</span>
</pre></div>
</div>
<p>Apply the State to the target by navigating to Systems, then selecting the desired target,
and under the States tab, click on the State created above and click Apply.</p>
</section>
</section>
<section id="purpose-of-the-opkg-keyrings-package">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Purpose of the <cite>opkg-keyrings</cite> package</a><a class="headerlink" href="#purpose-of-the-opkg-keyrings-package" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><p>Store Trusted Signing Keys</p>
<blockquote>
<div><ul class="simple">
<li><p>The package includes the public keys required to verify package or feed signatures.</p></li>
<li><p>These keys are placed in specific directories, such as /usr/share/opkg/keyrings/.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Ensure Package Integrity</p>
<blockquote>
<div><ul class="simple">
<li><p>During installation, opkg checks package signatures using these keys.</p></li>
<li><p>This prevents unauthorized or tampered packages from being installed.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Key Management</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>The <cite>opkg-keyrings</cite> package is updated when signing keys are rotated (e.g., when</dt><dd><p>old keys are retired, and new ones are issued).</p>
</dd>
</dl>
</li>
<li><p>Upgrading this package ensures the keyring remains current and secure.</p></li>
</ul>
</div></blockquote>
</li>
</ol>
</section>
</section>
<section id="opkg-signing">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Opkg Signing</a><a class="headerlink" href="#opkg-signing" title="Link to this heading">¶</a></h2>
<p>The package feeds are signed with a private key and the corresponding
public key is included in the <cite>opkg-keyrings</cite> package. When the feed is
updated, opkg checks the feed signature against the public key to
verify its authenticity and integrity.</p>
<ol class="arabic">
<li><p>Generate and Sign the Package Index</p>
<blockquote>
<div><ul class="simple">
<li><p>A pair of private and public keys is created using a tool like gpg.</p></li>
<li><p>The private key is used to sign the package index (package index,
the <em>Packages</em> and <em>Packages.gz</em> files in the case of NILRT).</p></li>
<li><dl class="simple">
<dt>A detached signature (<em>Packages.asc</em>) is generated and placed alongside the</dt><dd><p><em>Packages</em> file.</p>
</dd>
</dl>
</li>
<li><p>The public key is distributed to the target systems.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Verify Signature When a Feed is Updated</p>
<blockquote>
<div><ul class="simple">
<li><p>When opkg updates a package feed, it verifies the signature of the <em>Packages</em> file
using the public key.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Trust Management</p>
<blockquote>
<div><ul class="simple">
<li><p>The public key is preloaded or added to the system’s trusted keyring, such as
opkg-key (see <a class="reference internal" href="#how-keys-are-added-to-the-opkg-keyrings"><span class="std std-ref">How keys are added to the opkg-keyrings</span></a> for more details
on how this is accomplished).</p></li>
<li><p>While updating the feed (running <cite>opkg udpate</cite>), opkg verifies the signature.</p></li>
</ul>
</div></blockquote>
</li>
</ol>
</section>
<section id="how-keys-are-added-to-the-opkg-keyrings">
<span id="id2"></span><h2><a class="toc-backref" href="#id10" role="doc-backlink">How keys are added to the <cite>opkg-keyrings</cite></a><a class="headerlink" href="#how-keys-are-added-to-the-opkg-keyrings" title="Link to this heading">¶</a></h2>
<p>The Base System Image includes the signing keys, typically located at /usr/share/opkg/keyrings,
preloaded into the keyring.</p>
<p>However, if the signing keys used by the feeds are rotated, the target system requires an update
to add the new key and remove any obsolete keys no longer in use.</p>
<p>The latest version of the <cite>opkg-keyrings</cite> package, available on the distribution feed
(<a class="reference external" href="https://download.ni.com/#ni-linux-rt/feeds/dist/">https://download.ni.com/#ni-linux-rt/feeds/dist/</a>), is built with the updated signing keys.
Upgrading this package on the target system installs the new signing key to
/usr/share/opkg/keyrings, updates the keyring by adding the new key, and
removes any deprecated keys no longer used to sign the feeds.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">NI Linux Real-Time and <cite>opkg-keyrings</cite>: Upgrading keyrings</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#how-to-upgrade-the-keyring-via-the-command-line-max-or-systemlink">How to upgrade the keyring via the command line, MAX, or SystemLink</a><ul>
<li><a class="reference internal" href="#command-line">Command Line</a></li>
<li><a class="reference internal" href="#max">MAX</a><ul>
<li><a class="reference internal" href="#adding-the-rt-target-to-max">Adding the RT target to MAX</a></li>
<li><a class="reference internal" href="#upgrading-the-opkg-keyrings-package">Upgrading the <cite>opkg-keyrings</cite> package</a></li>
</ul>
</li>
<li><a class="reference internal" href="#systemlink">SystemLink</a><ul>
<li><a class="reference internal" href="#adding-the-rt-target-to-systemlink">Adding the RT target to SystemLink</a></li>
<li><a class="reference internal" href="#id1">Upgrading the <cite>opkg-keyrings</cite> package</a></li>
</ul>
</li>
<li><a class="reference internal" href="#purpose-of-the-opkg-keyrings-package">Purpose of the <cite>opkg-keyrings</cite> package</a></li>
</ul>
</li>
<li><a class="reference internal" href="#opkg-signing">Opkg Signing</a></li>
<li><a class="reference internal" href="#how-keys-are-added-to-the-opkg-keyrings">How keys are added to the <cite>opkg-keyrings</cite></a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../opkg/dkms_opkg.html"
                          title="previous chapter">NI Linux Real-Time and opkg: Distributing DKMS-based Kernel Modules</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../docker/docker.html"
                          title="next chapter">NI Linux Real-Time and Docker</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>GitHub Source</h3>
    <ul class="this-page-menu">
      <li><a href="https://github.com/ni/nilrt-docs/"
            rel="nofollow">Source on GitHub</a></li>
      <li><a href="https://github.com/ni/nilrt-docs/blob/main/docs/source/opkg-keyrings/opkg-keyrings_index.rst"
            rel="nofollow">Show Document Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../docker/docker.html" title="NI Linux Real-Time and Docker"
             >next</a> |</li>
        <li class="right" >
          <a href="../opkg/dkms_opkg.html" title="NI Linux Real-Time and opkg: Distributing DKMS-based Kernel Modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">nilrt-docs 1.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NI Linux Real-Time and <cite>opkg-keyrings</cite>: Upgrading keyrings</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright NI.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>