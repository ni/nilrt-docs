

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Part 3: Configuring Visual Studio Code for Building NI Linux Real-Time C/C++ Code &#8212; nilrt-docs 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Part 4: “Hello, World!” with Visual Studio Code and NI Linux Real-Time" href="hello_world.html" />
    <link rel="prev" title="Part 2: Configuring a Development System with Visual Studio Code and the NI Linux Real-Time C/C++ Compilers" href="config_dev_system.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="hello_world.html" title="Part 4: “Hello, World!” with Visual Studio Code and NI Linux Real-Time"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="config_dev_system.html" title="Part 2: Configuring a Development System with Visual Studio Code and the NI Linux Real-Time C/C++ Compilers"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">nilrt-docs 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="cross_compile_index.html" accesskey="U">NI Linux Real-Time Cross Compiling: Using the NI Linux Real-Time Cross Compile Toolchain with Visual Studio Code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Part 3: Configuring Visual Studio Code for Building NI Linux Real-Time C/C++ Code</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="part-3-configuring-visual-studio-code-for-building-ni-linux-real-time-c-c-code">
<h1>Part 3: Configuring Visual Studio Code for Building NI Linux Real-Time C/C++ Code<a class="headerlink" href="#part-3-configuring-visual-studio-code-for-building-ni-linux-real-time-c-c-code" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#creating-projects" id="id2">Creating Projects</a></p></li>
<li><p><a class="reference internal" href="#creating-tasks-and-the-command-palette" id="id3">Creating Tasks and the Command Palette</a></p></li>
<li><p><a class="reference internal" href="#configuring-the-c-c-extension-for-intellisense" id="id4">Configuring the C/C++ Extension for IntelliSense</a></p></li>
<li><p><a class="reference internal" href="#creating-a-debugging-configuration" id="id5">Creating a Debugging Configuration</a></p></li>
<li><p><a class="reference internal" href="#creating-a-cmake-build-configuration" id="id6">Creating a CMake Build Configuration</a></p></li>
<li><p><a class="reference internal" href="#expanding-on-the-template" id="id7">Expanding on the Template</a></p></li>
<li><p><a class="reference internal" href="#next-steps" id="id8">Next Steps</a></p></li>
</ul>
</div>
<section id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Creating code using Visual Studio Code and the NI Linux Real-Time C/C++
Compiler toolchain starts with the creation and configuration of files
that represent a project. As this process is similar for all types of
builds that the C/C++ compiler will perform, the initial setup done here
can be considered a project template for all types of builds.</p>
</section>
<section id="creating-projects">
<h2><a class="toc-backref" href="#id2">Creating Projects</a><a class="headerlink" href="#creating-projects" title="Permalink to this headline">¶</a></h2>
<p>Visual Studio Code does not use the idea of a “project” but rather acts
on directories or folders and the files within them. That is, instead of
opening a special project file Visual Studio Code opens a folder. In
addition to this folder concept Visual Studio Code uses workspaces which
are configurations used to group multiple top-level “project” folders
into one editor window.</p>
<p>Since these tutorials are focused on simple builds and establishing best
practices for working with the NI Linux Real-Time C/C++ tools all
projects will be single-root workspaces and will not require a workspace
configuration file. For more information about configuring workspaces,
refer to <a class="reference external" href="https://code.visualstudio.com/docs/getstarted/settings">User and Workspace
Settings</a> and
<a class="reference external" href="https://code.visualstudio.com/docs/editor/multi-root-workspaces">Multi-root
Workspaces</a>.</p>
<p>To create a new top-level directory with accompanying subdirectories in
Visual Studio Code, follow the steps below.</p>
<ol class="arabic">
<li><p>Create a top-level directory to act as the Folder for a VS Code
workspace. For example: <em>&lt;My Documents&gt;\HelloWorld\* or *&lt;My
Documents&gt;\NI Linux Real-Time Template\</em>.</p></li>
<li><p>Launch VS Code.</p></li>
<li><div class="line-block">
<div class="line">In VS Code, select <strong>Open folder…</strong> from the landing page or <strong>File
&gt;&gt; Open Folder…</strong></div>
</div>
<img alt="../_images/image112.png" src="../_images/image112.png" />
</li>
<li><p>Navigate to and select the folder created previously to open it in VS
Code.</p></li>
<li><div class="line-block">
<div class="line">In the VS Code Explorer, create the following folders in the
HelloWorld folder using the <strong>New Folder</strong> button.</div>
</div>
<img alt="../_images/image210.png" src="../_images/image210.png" />
<ol class="arabic simple">
<li><p><em>src</em> – source code directory</p></li>
<li><p><em>build</em> – build files directory</p></li>
</ol>
</li>
<li><div class="line-block">
<div class="line">Confirm that the directory structure looks as follows:</div>
</div>
<img alt="../_images/image310.png" src="../_images/image310.png" />
</li>
</ol>
</section>
<section id="creating-tasks-and-the-command-palette">
<h2><a class="toc-backref" href="#id3">Creating Tasks and the Command Palette</a><a class="headerlink" href="#creating-tasks-and-the-command-palette" title="Permalink to this headline">¶</a></h2>
<p>Visual Studio Code allows execution of various commands through the
<strong>Command Palette</strong> which is accessible via the <strong>Ctrl + Shift + P</strong>
shortcut. This opens a list of the various commands and actions that are
available to use in a searchable list including extension commands,
editor navigation, debugging, and other common development tasks.</p>
<p>In addition to the pre-defined commands, custom commands can be added
through <a class="reference external" href="https://code.visualstudio.com/docs/editor/tasks">Tasks</a> in
Visual Studio Code. Tasks allow users to define custom commands through
arbitrary external commands. This empowers Visual Studio Code to utilize
external tools without requiring direct integration. For example, these
tutorials will use CMake and a shell task to call CMake will be created.
If desired, such a task could be defined as the default build action as
well.</p>
<p>To create custom tasks to interface with the tools selected for these
examples and which can be launched from the Command Palette, follow
these steps:</p>
<ol class="arabic">
<li><p>In Visual Studio Code, press <strong>Ctrl + Shift + P</strong> to open the Command
Palette.</p></li>
<li><div class="line-block">
<div class="line">In the Command Palette, search for <strong>Tasks: Configure Task</strong> and
select it.</div>
</div>
<img alt="../_images/image43.png" src="../_images/image43.png" />
</li>
<li><div class="line-block">
<div class="line">Select <strong>Create tasks.json file from template</strong> then select
<strong>Others</strong>. This will create a new folder and file in the project
folder: the <em>.vscode</em> directory and that <em>tasks.json</em> file. The
directory is the storage location for all project-specific
configurations.</div>
</div>
<img alt="../_images/image52.png" src="../_images/image52.png" />
</li>
<li><p>The <em>tasks.json</em> file should open automatically, but if not open it
from the <strong>Explorer</strong>. It should include a default “Hello World” type
task.</p></li>
<li><p>Complete <em>tasks.json</em> as follows. These commands will allow quick
usage of the external utilities such as CMake and Ninja directly from
Visual Studio Code.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// See https://go.microsoft.com/fwlink/?LinkId=733558</span><span class="w"></span>
<span class="w">  </span><span class="c1">// for the documentation about the tasks.json format</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;tasks&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;CMake Generate Build Files&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;shell&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cmake -G Ninja ${workspaceFolder}/build&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;cwd&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${workspaceFolder}/build&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;problemMatcher&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Ninja&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;shell&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ninja&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;cwd&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${workspaceFolder}/build&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;problemMatcher&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$gcc&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;clean&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;shell&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;command&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ninja clean&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;options&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;cwd&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${workspaceFolder}/build&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;problemMatcher&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p><strong>Note:</strong> The “$gcc” problemMatcher value requires the C/C++
Extension and allows Visual Studio Code to report compilation errors
in the <strong>Problems</strong> view. A problemMatcher of [] means that the
output is notscanned for errors and terminal output needs reviewed.</p>
</li>
<li><p>Save <em>tasks.json</em> and then close the file in the editor.</p></li>
</ol>
</section>
<section id="configuring-the-c-c-extension-for-intellisense">
<h2><a class="toc-backref" href="#id4">Configuring the C/C++ Extension for IntelliSense</a><a class="headerlink" href="#configuring-the-c-c-extension-for-intellisense" title="Permalink to this headline">¶</a></h2>
<p>The C/C++ extension – while in pre-release at the time of writing – is a
powerful extension from Microsoft that enables C/C++ IntelliSense
features such as autocompletion as well as debugger support and simple
build task capabilities. In this section, the necessary configuration
file will be created to allow the IntelliSense feature to find compiler
includes and other necessary resources.</p>
<ol class="arabic">
<li><p>Open the Command Palette by hitting <strong>Ctrl + Shift + P</strong>.</p></li>
<li><div class="line-block">
<div class="line">Search for and select <strong>C/C++: Edit Configurations (JSON)</strong>.</div>
</div>
<img alt="../_images/image72.png" src="../_images/image72.png" />
</li>
<li><div class="line-block">
<div class="line">This should automatically create a new file in the <em>.vscode</em>
directory: <em>c_cpp_properties.json</em>. The file should also be open in
the editor. For more information on <em>c_cpp_properties.json</em>, refer
to the official documentation at <a class="reference external" href="https://code.visualstudio.com/docs/cpp/c-cpp-properties-schema-reference">c_cpp_properties.json
reference</a>.</div>
</div>
<img alt="../_images/image83.png" src="../_images/image83.png" />
</li>
<li><p>In the editor, modify the configuration for the compiler to be used.</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">For NI Linux Real-Time x64 devices, complete the file as follows:</div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;compilerSysroots&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C:/build/18.0/x64/sysroots/&quot;</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;configurations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NI Linux Real-Time x64&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;compilerPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${compilerSysroots}/i686-nilrtsdkmingw32/usr/bin/x86_64-nilrt-linux/x86_64-nilrt-linux-gcc&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;compilerArgs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;--sysroot=${compilerSysroots}/core2-64-nilrt-linux/&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;includePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;${workspaceFolder}/&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;intelliSenseMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gcc-x64&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">],</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><div class="line-block">
<div class="line">For NI Linux Real-Time ARM devices, complete the file as follows:</div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;env&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;compilerSysroots&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C:/build/18.0/arm/sysroots/&quot;</span><span class="w"></span>
<span class="w">  </span><span class="p">},</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;configurations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;NI Linux Real-Time ARMv7&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;compilerPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${compilerSysroots}/i686-nilrtsdkmingw32/usr/bin/arm-nilrt-linux-gnueabi/arm-nilrt-linux-gnueabi-gcc&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;compilerArgs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;--sysroot=${compilerSysroots}/cortexa9-vfpv3-nilrt-linuxgnueabi/&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;includePath&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;${workspaceFolder}/&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;intelliSenseMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gcc-x86&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">],</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>Save <em>c_cpp_properties.json</em>, then close the file in the editor.</p></li>
<li><div class="line-block">
<div class="line">Note that the configuration created now shows in the lower-right
corner of Visual Studio Code. It’s possible to have multiple
configurations in the same file and then switch between them. For
example, the above configurations could be extended to create a
configuration file that covers both ARM and x64 NI Linux Real-Time
devices.</div>
</div>
<img alt="../_images/image113.png" src="../_images/image113.png" />
</li>
</ol>
</section>
<section id="creating-a-debugging-configuration">
<h2><a class="toc-backref" href="#id5">Creating a Debugging Configuration</a><a class="headerlink" href="#creating-a-debugging-configuration" title="Permalink to this headline">¶</a></h2>
<p>Visual Studio Code uses a configuration file called <em>launch.json</em> to
configure the debugger for the environment. With the addition of the
C/C++ extension, support for C/C++ debuggers such as the GNU Debugger is
added.</p>
<p>This section will create the debug (aka launch) configuration but will
not complete it. Each debugging session will have its own specific
values depending on the binary that is being debugged. For more
information on launch configurations for C/C++ code refer to the
<a class="reference external" href="https://code.visualstudio.com/docs/cpp/cpp-debug">Debugging</a>
documentation and <a class="reference external" href="https://code.visualstudio.com/docs/cpp/launch-json-reference">Configuring C/C++
debugging</a>.</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Hit <strong>Ctrl + Shift + P</strong> to open the Command Palette, then search
for and select <strong>Debug: Open launch.json.</strong> Then, select <strong>C/C++
(GDB)</strong>. This will create a <em>launch.json</em> with the template
structure already present.</div>
</div>
<img alt="../_images/image122.png" src="../_images/image122.png" />
<img alt="../_images/image133.png" src="../_images/image133.png" />
</li>
<li><p>Configure the resulting template for the specific toolchain, noting
that not all fields are currently completed.</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">For NI Linux Real-Time x64 devices, complete the file as follows:</div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.2.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;configurations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;x64 (gdb) Launch&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cppdbg&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;launch&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;program&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enter program name, for example ${workspaceFolder}/a.exe&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;stopAtEntry&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;cwd&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;environment&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;showDisplayString&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;MIMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gdb&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;miDebuggerPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C:/build/18.0/x64/sysroots/i686-nilrtsdkmingw32/usr/bin/x86_64-nilrt-linux/x86_64-nilrt-linux-gdb.exe&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;miDebuggerServerAddress&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;serveraddress:port&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><div class="line-block">
<div class="line">For NI Linux Real-Time ARM devices, complete the file as follows:</div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.2.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;configurations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ARM (gdb) Launch&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cppdbg&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;launch&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;program&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;enter program name, for example ${workspaceFolder}/a.exe&quot;</span><span class="w"></span>
<span class="w">      </span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;stopAtEntry&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;cwd&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;environment&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;showDisplayString&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;MIMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gdb&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;miDebuggerPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C:/build/18.0/arm/sysroots/i686-nilrtsdkmingw32/usr/bin/arm-nilrt-linux-gnueabi/arm-nilrt-linux-gnueabi-gdb.exe&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;miDebuggerServerAddress&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;serveraddress:port&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>Save <em>launch.json</em>.</p></li>
</ol>
</section>
<section id="creating-a-cmake-build-configuration">
<h2><a class="toc-backref" href="#id6">Creating a CMake Build Configuration</a><a class="headerlink" href="#creating-a-cmake-build-configuration" title="Permalink to this headline">¶</a></h2>
<p>CMake determines how to generate build files and what specific
configurations to use for a given design through scripts called
CMakeLists. These are text files with various variables and commands to
configure includes, compiler flags, and source files to compile. Since
every NI Linux Real-Time compilation will be similar in terms of the
compiler path, flags, and base include paths, a template can be made for
this as well.</p>
<p>This section will demonstrate some of the basics of creating a
CMakeLists.txt file for a project but will not dive into every single
setting. Some settings are project specific and will be added later in
specific build tutorials instead of here. For more information on the
various CMake variables and commands, refer to the official <a class="reference external" href="https://cmake.org/cmake/help/latest/index.html">CMake
documentation</a> for
the version of CMake used on the system. Many of the variables set are
required for cross compiling as documented in the CMake Wiki
<a class="reference external" href="https://gitlab.kitware.com/cmake/community/wikis/doc/cmake/CrossCompiling">CrossCompiling</a>
document.</p>
<p><strong>Note:</strong> The below steps assume the 18.0 compiler toolchains and Linux
Real-Time images. Paths may differ based on the toolchain and versions
used.</p>
<ol class="arabic">
<li><p>In the <em>build</em> directory of the project, create a new file using the
<strong>New File</strong> button. Name the file <em>CMakeLists.txt</em>.</p>
<img alt="../_images/image161.png" src="../_images/image161.png" />
<img alt="../_images/image171.png" src="../_images/image171.png" />
</li>
<li><p>The first thing needed in the configuration is the specific compiler
and search path settings for the NI Linux Real-Time toolchain.
Configure the <strong>CMAKE_SYSTEM_NAME</strong> and <strong>CMAKE_SYSTEM_PROCESSOR</strong> as
shown below. The <strong>CMAKE_SYSTEM_NAME</strong> should match the output of
“uname -s” on the target, and the <strong>CMAKE_SYSTEM_PROCESSOR</strong> should
match the output of “uname -p.”</p>
<ol class="arabic simple">
<li><p>For NI Linux Real-Time x64 targets:</p></li>
</ol>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SYSTEM_NAME</span><span class="w"> </span><span class="s">Linux</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SYSTEM_PROCESSOR</span><span class="w"> </span><span class="s">x86_64</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>For NI Linux Real-Time ARM targets:</p></li>
</ol>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SYSTEM_NAME</span><span class="w"> </span><span class="s">Linux</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SYSTEM_PROCESSOR</span><span class="w"> </span><span class="s">armv71</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>To make setting paths in other parts of the file easier, it’s
possible to use a variable. This is optional but saves the trouble of
typing out the full sysroot location each time.</p>
<ol class="arabic simple">
<li><p>For NI Linux Real-Time x64 targets:</p></li>
</ol>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">toolchainpath</span><span class="w"> </span><span class="s">C:/build/18.0/x64/sysroots</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>For NI Linux Real-Time ARM targets:</p></li>
</ol>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">toolchainpath</span><span class="w"> </span><span class="s">C:/build/18.0/arm/sysroots</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Next, configure the compilers for both C and C++. CMake will
automatically decide which compiler to used based on the files being
compiled for a given project.</p>
<ol class="arabic simple">
<li><p>For NI Linux Real-Time x64 targets:</p></li>
</ol>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_COMPILER</span><span class="w"> </span><span class="o">${</span><span class="nv">toolchainpath</span><span class="o">}</span><span class="s">/i686-nilrtsdk-mingw32/usr/bin/x86_64-nilrt-linux/x86_64-nilrt-linux-gcc.exe</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_COMPILER</span><span class="w"> </span><span class="o">${</span><span class="nv">toolchainpath</span><span class="o">}</span><span class="s">/i686-nilrtsdk-mingw32/usr/bin/x86_64-nilrt-linux/x86_64-nilrt-linux-g++.exe</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>For NI Linux Real-Time ARM targets:</p></li>
</ol>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_C_COMPILER</span><span class="w"> </span><span class="o">${</span><span class="nv">toolchainpath</span><span class="o">}</span><span class="s">/i686-nilrtsdk-mingw32/usr/bin/arm-nilrt-linux-gnueabi/armnilrt-linux-gnueabi-gcc.exe</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_COMPILER</span><span class="w"> </span><span class="o">${</span><span class="nv">toolchainpath</span><span class="o">}</span><span class="s">/i686-nilrtsdk-mingw32/usr/bin/arm-nilrt-linuxgnueabi/arm-nilrt-linux-gnueabi-g++.exe</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>The compiler flags, include directories, and sysroot should all be
defined in the script as well. Note that these are the NI recommended
compiler flags.</p>
<ol class="arabic simple">
<li><p>For NI Linux Real-Time x64 targets:</p></li>
</ol>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_SYSROOT</span><span class="w"> </span><span class="o">${</span><span class="nv">toolchainpath</span><span class="o">}</span><span class="s">/core2-64-nilrt-linux</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_&lt;LANG&gt;_STANDARD_INCLUDE_DIRECTORIES</span><span class="w"> </span><span class="o">${</span><span class="nv">toolchainpath</span><span class="o">}</span><span class="s">/core2-64-nilrtlinux/usr/include/c++/6.3.0</span><span class="w"> </span><span class="o">${</span><span class="nv">toolchainpath</span><span class="o">}</span><span class="s">/core2-64-nilrt-linux/usr/include/c++/6.3.0/x86_64-nilrtlinux</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_&lt;LANG&gt;_FLAGS</span><span class="w"> </span><span class="s2">&quot;-Wall -fmessage-length=0&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_&lt;LANG&gt;_FLAGS_DEBUG</span><span class="w"> </span><span class="s2">&quot;-O0 -g3&quot;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_&lt;LANG&gt;_FLAGS_RELEASE</span><span class="w"> </span><span class="s2">&quot;-O3&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic" start="2">
<li><p>For NI Linux Real-Time ARM targets:
.. code:: cmake</p>
<blockquote>
<div><p>set(CMAKE_SYSROOT ${toolchainpath}/cortexa9-vfpv3-nilrt-linux-gnueabi)
set(CMAKE_&lt;LANG&gt;_STANDARD_INCLUDE_DIRECTORIES ${toolchainpath}/cortexa9-vfpv3-nilrt-linuxgnueabi/usr/include/c++/6.3.0 ${toolchainpath}/cortexa9-vfpv3-nilrt-linuxgnueabi/usr/include/c++/6.3.0/arm-nilrt-linux-gnueabi)
set(CMAKE_&lt;LANG&gt;_FLAGS “-Wall -fmessage-length=0 -mfpu=vfpv3 -mfloat-abi=softfp”)
set(CMAKE_&lt;LANG&gt;_FLAGS_DEBUG “-O0 -g3”)
set(CMAKE_&lt;LANG&gt;_FLAGS_RELEASE “-O3”)</p>
</div></blockquote>
<p><strong>Note:</strong> NI recommends using the <strong>-mfpu=vfpv3
-mfloat-abi=softfp</strong> flags for ARM targets to improve
floating-point operation performance.</p>
</li>
</ol>
</li>
<li><p>Search behavior must be specified to ensure that the compiler doesn’t
unnecessarily pull in includes from the host system’s paths. This
configuration will be the same for both ARM and x64 NI Linux
Real-Time targets.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_FIND_ROOT_PATH_MODE_PROGRAM</span><span class="w"> </span><span class="s">NEVER</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_FIND_ROOT_PATH_MODE_LIBRARY</span><span class="w"> </span><span class="s">ONLY</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_FIND_ROOT_PATH_MODE_INCLUDE</span><span class="w"> </span><span class="s">ONLY</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_FIND_ROOT_PATH_MODE_PACKAGE</span><span class="w"> </span><span class="s">ONLY</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Save <em>CMakeLists.txt</em>. Note that the file is currently incomplete and
will need to be expanded upon when specifying a build target.</p></li>
</ol>
</section>
<section id="expanding-on-the-template">
<h2><a class="toc-backref" href="#id7">Expanding on the Template</a><a class="headerlink" href="#expanding-on-the-template" title="Permalink to this headline">¶</a></h2>
<p>While this document acts as a basic setup for cross-compiling for Linux
Real-Time devices, Visual Studio Code’s inherent flexibility allows for
greater improvements depending on the desired workflow. Some examples of
ways to improve on the template project include:</p>
<ul class="simple">
<li><p>Define a preLaunchTask for the debugger to launch gdbserver on an NI
Linux Real-Time target using SSH.</p></li>
<li><p>Configure a task as the default build task such that the <strong>Tasks: Run
Build Task</strong> option can be used for quicker execution of a build.</p></li>
<li><p>Use extensions to better integrate with external build tools, such as
the <a class="reference external" href="https://marketplace.visualstudio.com/items?itemName=vector-of-bool.cmake-tools">CMake
Tools</a>
extension.</p></li>
<li><p>Creating a <a class="reference external" href="https://cmake.org/cmake/help/latest/manual/cmake-toolchains.7.html">CMake toolchain
file</a>
for better portability of the compiler settings. For more
information, see the
<a class="reference external" href="https://gitlab.kitware.com/cmake/community/wikis/doc/cmake/CrossCompiling">CrossCompiling</a>
topic in the CMake Wiki.</p></li>
<li><p>Add source code control by registering Source Control Providers such
as Git. See <a class="reference external" href="https://code.visualstudio.com/docs/editor/versioncontrol">Using Version Control in VS
Code</a>
for more information on supported version control providers.</p></li>
</ul>
</section>
<section id="next-steps">
<h2><a class="toc-backref" href="#id8">Next Steps</a><a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<p>With the template project created, it’s time to create a Hello World
application and walk through building an executable.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Part 3: Configuring Visual Studio Code for Building NI Linux Real-Time C/C++ Code</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#creating-projects">Creating Projects</a></li>
<li><a class="reference internal" href="#creating-tasks-and-the-command-palette">Creating Tasks and the Command Palette</a></li>
<li><a class="reference internal" href="#configuring-the-c-c-extension-for-intellisense">Configuring the C/C++ Extension for IntelliSense</a></li>
<li><a class="reference internal" href="#creating-a-debugging-configuration">Creating a Debugging Configuration</a></li>
<li><a class="reference internal" href="#creating-a-cmake-build-configuration">Creating a CMake Build Configuration</a></li>
<li><a class="reference internal" href="#expanding-on-the-template">Expanding on the Template</a></li>
<li><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="config_dev_system.html"
                          title="previous chapter">Part 2: Configuring a Development System with Visual Studio Code and the NI Linux Real-Time C/C++ Compilers</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="hello_world.html"
                          title="next chapter">Part 4: “Hello, World!” with Visual Studio Code and NI Linux Real-Time</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/cross_compile/config_vs_code.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="hello_world.html" title="Part 4: “Hello, World!” with Visual Studio Code and NI Linux Real-Time"
             >next</a> |</li>
        <li class="right" >
          <a href="config_dev_system.html" title="Part 2: Configuring a Development System with Visual Studio Code and the NI Linux Real-Time C/C++ Compilers"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">nilrt-docs 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="cross_compile_index.html" >NI Linux Real-Time Cross Compiling: Using the NI Linux Real-Time Cross Compile Toolchain with Visual Studio Code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Part 3: Configuring Visual Studio Code for Building NI Linux Real-Time C/C++ Code</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright NI.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>