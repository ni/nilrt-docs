

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Part 6: Calling and Debugging a Shared Library with Visual Studio Code and NI Linux Real-Time &#8212; nilrt-docs 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bizstyle.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visual Studio Code Sample Project Templates" href="template_downloads.html" />
    <link rel="prev" title="Part 5: Building a Shared Library with Visual Studio Code and NI Linux Real-Time" href="build_shared_library.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="template_downloads.html" title="Visual Studio Code Sample Project Templates"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="build_shared_library.html" title="Part 5: Building a Shared Library with Visual Studio Code and NI Linux Real-Time"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">nilrt-docs 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="cross_compile_index.html" accesskey="U">NI Linux Real-Time Cross Compiling: Using the NI Linux Real-Time Cross Compile Toolchain with Visual Studio Code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Part 6: Calling and Debugging a Shared Library with Visual Studio Code and NI Linux Real-Time</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="part-6-calling-and-debugging-a-shared-library-with-visual-studio-code-and-ni-linux-real-time">
<h1>Part 6: Calling and Debugging a Shared Library with Visual Studio Code and NI Linux Real-Time<a class="headerlink" href="#part-6-calling-and-debugging-a-shared-library-with-visual-studio-code-and-ni-linux-real-time" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p>
<ul>
<li><p><a class="reference internal" href="#requirements" id="id2">Requirements</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuring-the-sysroot" id="id3">Configuring the Sysroot</a></p></li>
<li><p><a class="reference internal" href="#creating-a-project" id="id4">Creating a Project</a></p></li>
<li><p><a class="reference internal" href="#creating-the-c-source-code" id="id5">Creating the C Source Code</a></p></li>
<li><p><a class="reference internal" href="#building-the-shared-library" id="id6">Building the Shared Library</a></p>
<ul>
<li><p><a class="reference internal" href="#cmake-configuration" id="id7">CMake Configuration</a></p></li>
<li><p><a class="reference internal" href="#building" id="id8">Building</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#deploying-and-running-the-compiled-executable" id="id9">Deploying and Running the Compiled Executable</a></p></li>
<li><p><a class="reference internal" href="#debugging-remotely-with-gdb" id="id10">Debugging Remotely with GDB</a></p>
<ul>
<li><p><a class="reference internal" href="#configuring-launch-json" id="id11">Configuring launch.json</a></p></li>
<li><p><a class="reference internal" href="#debugging-the-remote-executable-and-shared-library" id="id12">Debugging the Remote Executable and Shared Library</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In addition to creating standalone applications and custom user
libraries, the NI Linux Real-Time GNU C/C++ toolchain allows the use of
external libraries in applications or code. This tutorial walks through
creating a C application to call and debug the shared library created in
Building a Shared Library with Visual Studio Code and NI Linux
Real-Time. Note that with the proper adjustments, this process can be
applied to any shared library.</p>
<section id="requirements">
<h3><a class="toc-backref" href="#id2">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>This tutorial requires the following software and hardware:</p>
<ul class="simple">
<li><p>A development PC configured as described in Configuring a Development
System with Visual Studio Code</p></li>
<li><p>A project template as described in Configuring Visual Studio Code for
Building NI Linux Real-Time C/C++ Code</p></li>
<li><p>The shared library and header file created in Building a Shared
Library with Visual Studio Code and NI Linux Real-Time.</p></li>
<li><p><strong>(Optional)</strong> A Linux Real-Time System (e.g., PXI or CompactRIO)
with SSH access enabled for deployment and debugging. The versions of
software installed on this device should match the toolchain version
used.</p></li>
</ul>
</section>
</section>
<section id="configuring-the-sysroot">
<h2><a class="toc-backref" href="#id3">Configuring the Sysroot</a><a class="headerlink" href="#configuring-the-sysroot" title="Permalink to this headline">¶</a></h2>
<p>For this tutorial the shared library will be dynamically linked. That
is, the library will remain external to the application but will be
loaded at run time by the final executable. For this to work the linker
must be able to find the library and the library must be in the same
location it will be on the deployed system. If the executable is unable
to locate the shared library at run time, it will not be able to run
properly without further configuration changes.</p>
<p>The following are standard Linux directory locations for shared
libraries:</p>
<ul class="simple">
<li><p><em>/lib/</em> - location for essential Linux OS libraries</p></li>
<li><p><em>/usr/lib/</em> - location for normal user mode libraries installed by
the OS package manager</p></li>
<li><p><em>/usr/local/lib/</em> - location for normal user mode libraries installed
from source or manually</p></li>
</ul>
<p>In this tutorial the shared library is deployed manually and will be
placed in the <em>/usr/local/lib/</em> directory. Since this tutorial is aimed
at a cross compile workflow, it’s not enough to simply place the shared
library in this location at deployment time. The library must be in that
same location both in the local sysroot and in the deployed system. If
this is not the case, the linker will either not be able to link the
shared library or will look for the shared library in the incorrect
location. This applies to third-party libraries that are installed on
the deployment system from the opkg package manager as well, and these
will need copied to the local sysroot to successfully use.</p>
<p>To add the shared library to the sysroot, follow the steps below. The
shared library will later be deployed to the remote system at the same
time as the built executable.</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">In a Windows Explorer window, navigate to the shared library to be
used.</div>
</div>
<img alt="../_images/image13.png" src="../_images/image13.png" />
</li>
<li><div class="line-block">
<div class="line">Right-click on the shared library and select <strong>Copy</strong> from the
context menu.</div>
</div>
<img alt="../_images/image21.png" src="../_images/image21.png" />
</li>
<li><p>Navigate to the local copy of the sysroot for the NI Linux Real-Time
GNU C/C++ Compiler that the executable will be built with. The
sysroot will be included in the files installed with the NI Linux
Real-Time GNU C/C++ Compiler and is contained in the directory the
toolchain was installed to.</p>
<ol class="arabic simple">
<li><p>For x64 NI Linux Real-Time devices, this should be <em>&lt;toolchain
root path&gt;/sysroots/core2-64-nilrt-linux/usr/local/lib</em>.</p></li>
<li><p>For ARMv7 NI Linux Real-Time devices, this should be <em>&lt;toolchain
root path&gt;/sysroots/</em>
<em>cortexa9-vfpv3-nilrt-linux-gnueabi/usr/local/lib.</em></p></li>
</ol>
</li>
<li><div class="line-block">
<div class="line">Paste the shared library in the sysroot directory by right-clicking
anywhere in the directory and selecting <strong>Paste</strong> from the context
menu.</div>
</div>
<img alt="../_images/image31.png" src="../_images/image31.png" />
</li>
<li><div class="line-block">
<div class="line">Repeat steps 1 through 4 above with the header file for the shared
library, placing it in the <em>&lt;toolchain root
path&gt;/sysroots/core2-64-nilrt-linux/usr/local/include</em> or
<em>&lt;toolchain root path&gt;/sysroots/
cortexa9-vfpv3-nilrt-linux-gnueabi/usr/local/include</em> directory
depending on the toolchain used.</div>
<div class="line"><strong>Note:</strong> The /usr/local/include directory may not exist in the
sysroot by default. If it is not present, simply create the
directory.</div>
</div>
<img alt="../_images/image41.png" src="../_images/image41.png" />
</li>
</ol>
</section>
<section id="creating-a-project">
<h2><a class="toc-backref" href="#id4">Creating a Project</a><a class="headerlink" href="#creating-a-project" title="Permalink to this headline">¶</a></h2>
<p>This tutorial assumes that a template project for ARMv7 or x64 NI Linux
Real-Time Targets has been created as detailed in Configuring Visual
Studio Code for Building NI Linux Real-Time C/C++ Code. With a template
created as described there, the following steps can be taken to create a
new project:</p>
<ol class="arabic">
<li><p>Create a new directory to serve as the top-level project directory.</p></li>
<li><div class="line-block">
<div class="line">Copy the contents of the template project directory into this newly
created directory.</div>
</div>
<img alt="../_images/image5.png" src="../_images/image5.png" />
</li>
<li><p>Open the folder in Visual Studio Code by doing one of the following:</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Right-click anywhere in the folder and select <strong>Open with
Code</strong>.</div>
</div>
<img alt="../_images/image6.png" src="../_images/image6.png" />
</li>
<li><div class="line-block">
<div class="line">Launch Visual Studio Code, then select <strong>File &gt;&gt; Open Folder</strong>
and choose the folder to open.</div>
</div>
<img alt="../_images/image7.png" src="../_images/image7.png" />
</li>
</ol>
</li>
<li><div class="line-block">
<div class="line">Confirm that the folder opened properly in Visual Studio Code in
the <strong>Explorer.</strong></div>
</div>
<img alt="../_images/image81.png" src="../_images/image81.png" />
</li>
<li><p>In the <em>.vscode</em> directory of the project, open
<em>c_cpp_properties.json</em>.</p></li>
<li><div class="line-block">
<div class="line">Add the <em>/usr/local/include</em> directory from the <strong>Configuring the
Sysroot</strong> portion of this document to the <strong>includePath</strong> to ensure
includes in that directory are found by IntelliSense.</div>
</div>
<img alt="../_images/image91.png" src="../_images/image91.png" />
</li>
</ol>
</section>
<section id="creating-the-c-source-code">
<h2><a class="toc-backref" href="#id5">Creating the C Source Code</a><a class="headerlink" href="#creating-the-c-source-code" title="Permalink to this headline">¶</a></h2>
<p>To test the library, a simple C application will be used to call a
function from that library. The example library only has one function,
so this is straight forward.</p>
<ol class="arabic">
<li><p>In the <em>src</em> directory of the project, create a new source file
titled <em>callingSharedLibary.c.</em></p></li>
<li><p>Complete the source file as shown below.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;myLib.h&gt;</span><span class="cp"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;Enter the first number to add:&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">puts</span><span class="p">(</span><span class="s">&quot;Enter the second number to add:&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">scanf</span><span class="p">(</span><span class="s">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d + %d = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Save <em>callingSharedLibrary.c</em>.</p></li>
</ol>
</section>
<section id="building-the-shared-library">
<h2><a class="toc-backref" href="#id6">Building the Shared Library</a><a class="headerlink" href="#building-the-shared-library" title="Permalink to this headline">¶</a></h2>
<section id="cmake-configuration">
<h3><a class="toc-backref" href="#id7">CMake Configuration</a><a class="headerlink" href="#cmake-configuration" title="Permalink to this headline">¶</a></h3>
<p>CMake uses a <em>CMakeLists.txt</em> file for any build configuration. That is,
the actual CMake program takes its instructions from a <em>CMakeLists.txt</em>
file that defines one or more build targets and the configurations
necessary for them. Since the template project already contains a
<em>CMakeLists.txt</em> with the compiler and include configurations required
for all NI Linux Real-Time compilations, only the project specific
configurations need added. For more information on these configurations,
refer to the official <a class="reference external" href="https://cmake.org/cmake/help/latest/">CMake
documentation</a>.</p>
<ol class="arabic">
<li><p>Open the <em>&lt;project directory&gt;/build/CMakeLists.txt</em> file in the
Visual Studio Code editor.</p></li>
<li><p>Add the following lines to the end of the file. Note the inclusion of
the <em>&lt;sysroot&gt;/usr/local/include</em> as an include directory. This
ensures the compiler knows to look at items in that directory when
searching for includes. The <em>/usr/local</em> directories are not included
in the default include directories by the NI Linux Real-Time GNU
C/C++ compiler.</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">For x64 NI Linux Real-Time devices:</div>
</div>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># project specific information</span>
<span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.14</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">callingSharedObject</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">EXECUTABLE_OUTPUT_PATH</span><span class="w"> </span><span class="s">bin</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_BUILD_TYPE</span><span class="w"> </span><span class="s">Debug</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">callingSharedObject</span><span class="w"> </span><span class="s">../src/callingSharedObject.c</span><span class="p">)</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">toolchain_path</span><span class="o">}</span><span class="s">/core2-64-nilrtlinux/usr/local/include</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">callingSharedObject</span><span class="w"> </span><span class="s">myLib</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><div class="line-block">
<div class="line">For ARMv7 NI Linux Real-Time devices:</div>
</div>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># project specific information</span>
<span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.14</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">callingSharedObject</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">EXECUTABLE_OUTPUT_PATH</span><span class="w"> </span><span class="s">bin</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_BUILD_TYPE</span><span class="w"> </span><span class="s">Debug</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">callingSharedObject</span><span class="w"> </span><span class="s">../src/callingSharedObject.c</span><span class="p">)</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">toolchain_path</span><span class="o">}</span><span class="s">/cortexa9-vfpv3-nilrt-linuxgnueabi/usr/local/include</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">callingSharedObject</span><span class="w"> </span><span class="s">myLib</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p>Save <em>CMakeLists.txt.</em></p></li>
</ol>
</section>
<section id="building">
<h3><a class="toc-backref" href="#id8">Building</a><a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h3>
<p>With a completed build configuration, Visual Studio Tasks will be used
to build the output binaries. Refer to the <a class="reference external" href="https://code.visualstudio.com/docs/editor/tasks">Integrate with External
Tools via Tasks</a> for
more information on creating and using tasks.</p>
<ol class="arabic">
<li><p>Run the custom task to invoke CMake. Open the command palette via
<strong>Ctrl + Shift + P</strong> or <strong>View &gt;&gt; Command Palette…</strong></p></li>
<li><div class="line-block">
<div class="line">Search for and select <strong>Tasks: Run Task</strong> in the Command Palette.
This will pull up a list of the custom tasks available in the
project.</div>
</div>
<img alt="../_images/image131.png" src="../_images/image131.png" />
</li>
<li><div class="line-block">
<div class="line">From the list of custom tasks, select <strong>CMake Generate Build
Files</strong> or the equivalent task in the project’s <em>tasks.json</em> if a
different name was used.</div>
</div>
<img alt="../_images/image14.png" src="../_images/image14.png" />
</li>
<li><div class="line-block">
<div class="line">Confirm that the task runs and completes successfully in the
Terminal window. There should be several new files in the <em>build/</em>
directory of the project including a new <em>bin/</em> directory for the
build output, <em>build.ninja,</em> and <em>CMakeCache.txt</em>.</div>
</div>
<img alt="../_images/image15.png" src="../_images/image15.png" />
</li>
<li><p>Run the build using Ninja using the task defined in <em>tasks.json</em>.
Open the Command Palette and select <strong>Tasks: Run Task</strong> again.</p></li>
<li><div class="line-block">
<div class="line">Select <strong>Ninja</strong> or the name used for the Ninja build task in the
project’s <em>tasks.json</em> file.</div>
</div>
<img alt="../_images/image16.png" src="../_images/image16.png" />
</li>
<li><div class="line-block">
<div class="line">Confirm that the build task runs successfully and that there is now
a <em>callingSharedObject</em> binary in the <em>&lt;project folder&gt;/build/bin</em>
directory.</div>
</div>
<img alt="../_images/image17.png" src="../_images/image17.png" />
</li>
</ol>
</section>
</section>
<section id="deploying-and-running-the-compiled-executable">
<h2><a class="toc-backref" href="#id9">Deploying and Running the Compiled Executable</a><a class="headerlink" href="#deploying-and-running-the-compiled-executable" title="Permalink to this headline">¶</a></h2>
<p>For the built executable binary to run properly, the shared library and
executable must both be deployed and given execute permissions. The
steps required to accomplish this using FileZilla are below, but any
method of copying the files to the correct location and changing the
permissions can be used.</p>
<ol class="arabic">
<li><div class="line-block">
<div class="line">Ensure that SSH is enabled on the Linux Real-Time system. For
systems using *.ipk-based installations such as PXI Linux
Real-Time devices, this will be enabled by default once a System
Image is installed. For other Linux Real-Time systems, SSH can be
enabled in NI MAX in the <strong>System Settings</strong> for the device.</div>
</div>
<img alt="../_images/image18.png" src="../_images/image18.png" />
</li>
<li><p>Launch FileZilla.</p></li>
<li><div class="line-block">
<div class="line">In FileZilla, connect to the Linux Real-Time target using the IP
Address or Hostname, admin account, and Port 22. Click
<strong>Quickconnect</strong> to open the connection.</div>
</div>
<img alt="../_images/image19.png" src="../_images/image19.png" />
</li>
<li><div class="line-block">
<div class="line">In the <strong>Remote site</strong>, ensure that the directory location is
<em>/home/admin</em>. Create a new directory for the binary deployment
with a descriptive name (e.g., <em>callingSharedLibrary/</em>).</div>
</div>
<img alt="../_images/image20.png" src="../_images/image20.png" />
</li>
<li><p>Open the new directory in the <strong>Remote site</strong> side of FileZilla.</p></li>
<li><div class="line-block">
<div class="line">On the <strong>Local site</strong> side, navigate to the location of the
executable binary to be deployed.</div>
</div>
<img alt="../_images/image211.png" src="../_images/image211.png" />
</li>
<li><div class="line-block">
<div class="line">Copy the binary by double-clicking it in the local file system
view. A copy should now appear in the remote file system.</div>
</div>
<img alt="../_images/image22.png" src="../_images/image22.png" />
</li>
<li><div class="line-block">
<div class="line">By default, the file will not have any execute permissions defined
and will not be executable. This can be fixed by right-clicking
the remote copy of the file and selecting the <strong>File
permissions…</strong> item from the context menu or directly from a shell
using the <strong>chmod</strong> command.</div>
</div>
<img alt="../_images/image23.png" src="../_images/image23.png" />
</li>
<li><p>Repeat steps 1-9 to deploy the shared library to the
<em>/usr/local/lib</em> directory on the remote system. Ensure that it has
the same execute permissions as the executable. <strong>The executable
will not run properly if this step is skipped.</strong></p></li>
<li><p>Close FileZilla.</p></li>
<li><p>Open PuTTY.</p></li>
<li><div class="line-block">
<div class="line">Select a <strong>Connection type</strong> of <strong>SSH</strong> and enter the <strong>Host Name
(or IP Address)</strong> of the target. Confirm that the <strong>Port</strong> field
is set to <strong>22</strong> and then click <strong>Open.</strong></div>
</div>
<img alt="../_images/image24.png" src="../_images/image24.png" />
</li>
<li><div class="line-block">
<div class="line">Log into the target as the admin user.</div>
</div>
<img alt="../_images/image25.png" src="../_images/image25.png" />
</li>
<li><div class="line-block">
<div class="line">Change directories to the location of the deployed binary.</div>
</div>
<img alt="../_images/image26.png" src="../_images/image26.png" />
</li>
<li><div class="line-block">
<div class="line">Run the executable and confirm that it works properly. Make sure
to enter input when prompted by the application.</div>
</div>
<img alt="../_images/image27.png" src="../_images/image27.png" />
</li>
</ol>
</section>
<section id="debugging-remotely-with-gdb">
<h2><a class="toc-backref" href="#id10">Debugging Remotely with GDB</a><a class="headerlink" href="#debugging-remotely-with-gdb" title="Permalink to this headline">¶</a></h2>
<p>Debugging remotely with Visual Studio Code will allow debugging of both
the shared object and the executable using the GNU Debugger. NI includes
gdbserver on NI Linux Real-Time targets by default, while the NI Linux
Real-Time GNU C/C++ toolchain includes the GNU Debugger to connect to
the remote system.</p>
<p>Visual Studio Code allows configurations for remote debugging through
the properties set in the <em>launch.json</em> file for a given project. In
this file, the remote target, gdbserver port, and executable to be
debugged are defined before launching a connection to the remote debug
server.</p>
<section id="configuring-launch-json">
<h3><a class="toc-backref" href="#id11">Configuring launch.json</a><a class="headerlink" href="#configuring-launch-json" title="Permalink to this headline">¶</a></h3>
<p>The <em>launch.json</em> file contains the information necessary to allow
Visual Studio Code to use a debugger such as the GNU Debugger (gdb). For
more information on launch configurations and debugging in Visual Studio
Code, refer to <a class="reference external" href="https://code.visualstudio.com/docs/cpp/launch-json-reference">Configuring C/C++
debugging</a>.</p>
<ol class="arabic">
<li><p>In Visual Studio Code, open the <em>&lt;project
folder&gt;/.vscode/launch.json</em> file. This file should have some
information such as the <strong>miDebuggerPath</strong> completed already as part
of the template project creation.</p></li>
<li><p>Complete <em>launch.json</em> for the “Hello, World!” application as shown
below. Specifically, the <strong>program</strong> and <strong>miDebuggerServerAddress</strong>
fields using the IP address of the remote NI Linux Real-Time device
and the local binary build.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// Use IntelliSense to learn about possible attributes.</span><span class="w"></span>
<span class="w">  </span><span class="c1">// Hover to view descriptions of existing attributes.</span><span class="w"></span>
<span class="w">  </span><span class="c1">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.2.0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="nt">&quot;configurations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;x64 (gdb) Launch&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cppdbg&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;request&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;launch&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;program&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;${workspaceFolder}/build/bin/callingSharedObject&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;stopAtEntry&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;cwd&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;environment&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;showDisplayString&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;MIMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;gdb&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;miDebuggerPath&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;C:/build/18.0/x64/sysroots/i686-nilrtsdkmingw32/usr/bin/x86_64-nilrt-linux/x86_64-nilrt-linux-gdb.exe&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="nt">&quot;miDebuggerServerAddress&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10.2.110.136:9092&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p><strong>(Optional)</strong> To debug the shared library as well, the debugger will
need access to the source files for that library. Note that GDB will
look for the source files for the shared library at the location they
were located on the development machine when the shared library was
built. If these files have moved, <a class="reference external" href="https://code.visualstudio.com/docs/cpp/launch-json-reference#_sourcefilemap">the sourceFileMap
option</a>
can be configured in <em>launch.json</em> to redirect the debugger to the
correct file locations.</p></li>
<li><p>Save <em>launch.json</em></p></li>
</ol>
</section>
<section id="debugging-the-remote-executable-and-shared-library">
<h3><a class="toc-backref" href="#id12">Debugging the Remote Executable and Shared Library</a><a class="headerlink" href="#debugging-the-remote-executable-and-shared-library" title="Permalink to this headline">¶</a></h3>
<p>Debugging the executable on the remote system requires launching
gdbserver with the executable at the port specified in <em>launch.json</em>
then run the launch profile defined in Visual Studio Code to connect the
debugger. Once the debugger is connected, standard debugging tools such
as breakpoints are available.</p>
<ol class="arabic">
<li><p>If not already connected to the remote NI Linux Real-Time device,
open PuTTY and connect via SSH.</p></li>
<li><div class="line-block">
<div class="line">Change directories to the location of the debuggable binary.</div>
</div>
<img alt="../_images/image29.png" src="../_images/image29.png" />
</li>
<li><div class="line-block">
<div class="line">Launch gdbserver at the port defined in <em>launch.json</em>. This should
result in gdbserver listening for any connections from a gdb
connection at that port.</div>
</div>
<img alt="../_images/image30.png" src="../_images/image30.png" />
</li>
<li><p>In Visual Studio Code, open <em>callingSharedObject.c</em> in the editor.</p></li>
<li><div class="line-block">
<div class="line">Switch to the Debug view by clicking the <strong>Debug</strong> icon.</div>
</div>
<img alt="../_images/image311.png" src="../_images/image311.png" />
</li>
<li><div class="line-block">
<div class="line">In the Debug view, ensure that the launch configuration defined is
selected as the configuration.</div>
</div>
<img alt="../_images/image32.png" src="../_images/image32.png" />
</li>
<li><div class="line-block">
<div class="line">In the <em>callingSharedObject.c</em> source file, click to the left of
the function from the shared library to place a breakpoint and
pause execution at that point.</div>
</div>
<img alt="../_images/image33.png" src="../_images/image33.png" />
</li>
<li><div class="line-block">
<div class="line">Connect to the remote gdbserver by clicking the <strong>Start
Debugging</strong> button.</div>
</div>
<img alt="../_images/image34.png" src="../_images/image34.png" />
</li>
<li><div class="line-block">
<div class="line">Confirm that the program is now running in the SSH terminal
window. Interact with the program to progress to the breakpoint.
Confirm that the debugging view in Visual Studio Code now shows
execution stopped at that point.</div>
</div>
<img alt="../_images/image35.png" src="../_images/image35.png" />
<img alt="../_images/image36.png" src="../_images/image36.png" />
</li>
<li><div class="line-block">
<div class="line">Use the debugging tools in Visual Studio Code to debug the
application and shared library. In particular, try stepping into
the shared library function to debug the library call.</div>
</div>
<img alt="../_images/image37.png" src="../_images/image37.png" />
</li>
<li><div class="line-block">
<div class="line">Complete execution of the program by click the <strong>Continue</strong> button
or hitting <strong>F5</strong>. Note the exit status of the application in both
the <strong>Debug Console</strong> in Visual Studio Code and the SSH Session.</div>
</div>
<img alt="../_images/image39.png" src="../_images/image39.png" />
<img alt="../_images/image39.png" src="../_images/image39.png" />
</li>
</ol>
<p><strong>Note:</strong> While debugging, not all symbols or source files for the Linux
Kernel are available. If an attempt to step into that code is made,
Visual Studio Code may be unable to open or find that certain source
files. If this occurs, finish debugging with either <strong>Continue</strong> or
<strong>Stop.</strong></p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Part 6: Calling and Debugging a Shared Library with Visual Studio Code and NI Linux Real-Time</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuring-the-sysroot">Configuring the Sysroot</a></li>
<li><a class="reference internal" href="#creating-a-project">Creating a Project</a></li>
<li><a class="reference internal" href="#creating-the-c-source-code">Creating the C Source Code</a></li>
<li><a class="reference internal" href="#building-the-shared-library">Building the Shared Library</a><ul>
<li><a class="reference internal" href="#cmake-configuration">CMake Configuration</a></li>
<li><a class="reference internal" href="#building">Building</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deploying-and-running-the-compiled-executable">Deploying and Running the Compiled Executable</a></li>
<li><a class="reference internal" href="#debugging-remotely-with-gdb">Debugging Remotely with GDB</a><ul>
<li><a class="reference internal" href="#configuring-launch-json">Configuring launch.json</a></li>
<li><a class="reference internal" href="#debugging-the-remote-executable-and-shared-library">Debugging the Remote Executable and Shared Library</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="build_shared_library.html"
                          title="previous chapter">Part 5: Building a Shared Library with Visual Studio Code and NI Linux Real-Time</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="template_downloads.html"
                          title="next chapter">Visual Studio Code Sample Project Templates</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/cross_compile/call_shared_library.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="template_downloads.html" title="Visual Studio Code Sample Project Templates"
             >next</a> |</li>
        <li class="right" >
          <a href="build_shared_library.html" title="Part 5: Building a Shared Library with Visual Studio Code and NI Linux Real-Time"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">nilrt-docs 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="cross_compile_index.html" >NI Linux Real-Time Cross Compiling: Using the NI Linux Real-Time Cross Compile Toolchain with Visual Studio Code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Part 6: Calling and Debugging a Shared Library with Visual Studio Code and NI Linux Real-Time</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright NI.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>